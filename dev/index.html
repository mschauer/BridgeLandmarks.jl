<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Home · BridgeLandmarks.jl</title><link href="https://cdnjs.cloudflare.com/ajax/libs/normalize/4.2.0/normalize.min.css" rel="stylesheet" type="text/css"/><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/default.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.2.0/require.min.js" data-main="assets/documenter.js"></script><script src="siteinfo.js"></script><script src="../versions.js"></script><link href="assets/documenter.css" rel="stylesheet" type="text/css"/></head><body><nav class="toc"><h1>BridgeLandmarks.jl</h1><select id="version-selector" onChange="window.location.href=this.value" style="visibility: hidden"></select><form class="search" id="search-form" action="search/"><input id="search-query" name="q" type="text" placeholder="Search docs"/></form><ul><li class="current"><a class="toctext" href>Home</a><ul class="internal"></ul></li></ul></nav><article id="docs"><header><nav><ul><li><a href>Home</a></li></ul><a class="edit-page" href="https://github.com/mschauer/BridgeLandmarks.jl/blob/master/docs/src/index.md#L"><span class="fa"></span> Edit on GitHub</a></nav><hr/><div id="topbar"><span>Home</span><a class="fa fa-bars" href="#"></a></div></header><h1><a class="nav-anchor" id="BridgeLandmarks.jl-1" href="#BridgeLandmarks.jl-1">BridgeLandmarks.jl</a></h1><ul><li><a href="#BridgeLandmarks.GuidRecursions"><code>BridgeLandmarks.GuidRecursions</code></a></li><li><a href="#BridgeLandmarks.GuidedProposal!"><code>BridgeLandmarks.GuidedProposal!</code></a></li><li><a href="#BridgeLandmarks.ObsInfo"><code>BridgeLandmarks.ObsInfo</code></a></li><li><a href="#Base.:*-Tuple{BridgeLandmarks.InverseCholesky,Any}"><code>Base.:*</code></a></li><li><a href="#Base.:*-Tuple{BridgeLandmarks.InverseCholesky,BridgeLandmarks.NState}"><code>Base.:*</code></a></li><li><a href="#Base.conj!-Tuple{Array{#s24,2} where #s24&lt;:(StaticArrays.SArray{Tuple{2,2},T,2,4} where T)}"><code>Base.conj!</code></a></li><li><a href="#Base.show-Tuple{IO,BridgeLandmarks.NState}"><code>Base.show</code></a></li><li><a href="#Bridge.B-Tuple{Any,LandmarksAux}"><code>Bridge.B</code></a></li><li><a href="#Bridge.B-Tuple{Any,MarslandShardlowAux}"><code>Bridge.B</code></a></li><li><a href="#Bridge.B!-Tuple{Any,Any,Any,LandmarksAux}"><code>Bridge.B!</code></a></li><li><a href="#Bridge.B!-Tuple{Any,Any,Any,MarslandShardlowAux}"><code>Bridge.B!</code></a></li><li><a href="#Bridge._b!-Tuple{Any,BridgeLandmarks.NState,BridgeLandmarks.NState,BridgeLandmarks.GuidedProposal!,Any}"><code>Bridge._b!</code></a></li><li><a href="#Bridge.a-Tuple{Any,Union{MarslandShardlow, MarslandShardlowAux}}"><code>Bridge.a</code></a></li><li><a href="#Bridge.b!-Tuple{Any,Any,Any,MarslandShardlow}"><code>Bridge.b!</code></a></li><li><a href="#Bridge.b!-Tuple{Any,Any,Any,LandmarksAux}"><code>Bridge.b!</code></a></li><li><a href="#Bridge.b!-Tuple{Any,Any,Any,Landmarks}"><code>Bridge.b!</code></a></li><li><a href="#Bridge.σ!-Tuple{Any,Any,Any,Any,BridgeLandmarks.GuidedProposal!}"><code>Bridge.σ!</code></a></li><li><a href="#Bridge.σ!-Tuple{Any,Any,Any,Any,Union{MarslandShardlow, MarslandShardlowAux}}"><code>Bridge.σ!</code></a></li><li><a href="#Bridge.σ!-Tuple{Any,Any,Any,Any,Union{Landmarks, LandmarksAux}}"><code>Bridge.σ!</code></a></li><li><a href="#BridgeLandmarks.HMC-NTuple{5,Any}"><code>BridgeLandmarks.HMC</code></a></li><li><a href="#BridgeLandmarks._r!-Tuple{Any,BridgeLandmarks.NState,BridgeLandmarks.NState,BridgeLandmarks.GuidedProposal!,Any}"><code>BridgeLandmarks._r!</code></a></li><li><a href="#BridgeLandmarks.amul-Tuple{Any,BridgeLandmarks.NState,BridgeLandmarks.NState,Union{MarslandShardlow, MarslandShardlowAux}}"><code>BridgeLandmarks.amul</code></a></li><li><a href="#BridgeLandmarks.amul-Tuple{Any,BridgeLandmarks.NState,Array{#s17,1} where #s17&lt;:(StaticArrays.SArray{Tuple{2},T,1,2} where T),Union{Landmarks, LandmarksAux}}"><code>BridgeLandmarks.amul</code></a></li><li><a href="#BridgeLandmarks.amul-Tuple{Any,BridgeLandmarks.NState,BridgeLandmarks.NState,Union{Landmarks, LandmarksAux}}"><code>BridgeLandmarks.amul</code></a></li><li><a href="#BridgeLandmarks.cholinverse!-Tuple{Any,Any}"><code>BridgeLandmarks.cholinverse!</code></a></li><li><a href="#BridgeLandmarks.construct_nfs-Tuple{Any,Any,Any}"><code>BridgeLandmarks.construct_nfs</code></a></li><li><a href="#BridgeLandmarks.convert_samplepath-Tuple{Any}"><code>BridgeLandmarks.convert_samplepath</code></a></li><li><a href="#BridgeLandmarks.convert_samplepath-Tuple{Array{T,1} where T}"><code>BridgeLandmarks.convert_samplepath</code></a></li><li><a href="#BridgeLandmarks.getpars-Tuple{BridgeLandmarks.GuidedProposal!}"><code>BridgeLandmarks.getpars</code></a></li><li><a href="#BridgeLandmarks.guidingbackwards!-Tuple{BridgeLandmarks.Lm,Any,Any,Any,Any}"><code>BridgeLandmarks.guidingbackwards!</code></a></li><li><a href="#BridgeLandmarks.hamiltonian-Tuple{Any,Any}"><code>BridgeLandmarks.hamiltonian</code></a></li><li><a href="#BridgeLandmarks.init_guidrec-Tuple{Any,Any,Any}"><code>BridgeLandmarks.init_guidrec</code></a></li><li><a href="#BridgeLandmarks.kernel-Tuple{Any,Union{Landmarks, LandmarksAux, MarslandShardlow, MarslandShardlowAux}}"><code>BridgeLandmarks.kernel</code></a></li><li><a href="#BridgeLandmarks.landmarksforward-Union{Tuple{Pnt}, Tuple{Any,NState{Pnt,M} where M&lt;:AbstractArray{Pnt,2},Any}} where Pnt"><code>BridgeLandmarks.landmarksforward</code></a></li><li><a href="#BridgeLandmarks.lm_gpupdate!-Union{Tuple{Pnt}, Tuple{Any,Array{Pnt,2},Any,Any,Any,Any,Any}} where Pnt"><code>BridgeLandmarks.lm_gpupdate!</code></a></li><li><a href="#BridgeLandmarks.lm_mcmc-NTuple{15,Any}"><code>BridgeLandmarks.lm_mcmc</code></a></li><li><a href="#BridgeLandmarks.lyapunovpsdbackward_step!-NTuple{7,Any}"><code>BridgeLandmarks.lyapunovpsdbackward_step!</code></a></li><li><a href="#BridgeLandmarks.lρtilde-Tuple{Any,Any,Any}"><code>BridgeLandmarks.lρtilde</code></a></li><li><a href="#BridgeLandmarks.plotshapes-NTuple{4,Any}"><code>BridgeLandmarks.plotshapes</code></a></li><li><a href="#BridgeLandmarks.putpars!-Tuple{BridgeLandmarks.GuidedProposal!,Any}"><code>BridgeLandmarks.putpars!</code></a></li><li><a href="#BridgeLandmarks.set_obsinfo-Tuple{Any,Bool,Bool,Any,Any}"><code>BridgeLandmarks.set_obsinfo</code></a></li><li><a href="#BridgeLandmarks.simguidedlm_llikelihood!-Tuple{Bridge.LeftRule,Any,Any,Any,BridgeLandmarks.GuidedProposal!,Any}"><code>BridgeLandmarks.simguidedlm_llikelihood!</code></a></li><li><a href="#BridgeLandmarks.simguidedlm_llikelihood!-Tuple{Bridge.LeftRule,Any,Any,Any,BridgeLandmarks.GuidedProposal!}"><code>BridgeLandmarks.simguidedlm_llikelihood!</code></a></li><li><a href="#BridgeLandmarks.slogρ!-NTuple{5,Any}"><code>BridgeLandmarks.slogρ!</code></a></li><li><a href="#BridgeLandmarks.update_guidrec!-Tuple{Any,Any}"><code>BridgeLandmarks.update_guidrec!</code></a></li><li><a href="#BridgeLandmarks.update_initialstate!-Tuple{Any,Any,Any,Any,Any,Any,Any,Any,Any,BridgeLandmarks.GuidedProposal!,Any,Any}"><code>BridgeLandmarks.update_initialstate!</code></a></li><li><a href="#BridgeLandmarks.update_pars!-NTuple{10,Any}"><code>BridgeLandmarks.update_pars!</code></a></li><li><a href="#BridgeLandmarks.update_path!-NTuple{10,Any}"><code>BridgeLandmarks.update_path!</code></a></li><li><a href="#BridgeLandmarks.z-NTuple{4,Any}"><code>BridgeLandmarks.z</code></a></li><li><a href="#BridgeLandmarks.σp-Tuple{Any,Any,BridgeLandmarks.Noisefield}"><code>BridgeLandmarks.σp</code></a></li><li><a href="#BridgeLandmarks.σq-Tuple{Any,BridgeLandmarks.Noisefield}"><code>BridgeLandmarks.σq</code></a></li><li><a href="#BridgeLandmarks.σq-Tuple{Any,Array{#s13,1} where #s13&lt;:BridgeLandmarks.Noisefield}"><code>BridgeLandmarks.σq</code></a></li><li><a href="#BridgeLandmarks.σt!-Union{Tuple{Pnt}, Tuple{Any,Any,NState{Pnt,M} where M&lt;:AbstractArray{Pnt,2},Any,Union{Landmarks, LandmarksAux}}} where Pnt"><code>BridgeLandmarks.σt!</code></a></li><li><a href="#BridgeLandmarks.σt!-Union{Tuple{Pnt}, Tuple{Any,Any,NState{Pnt,M} where M&lt;:AbstractArray{Pnt,2},Any,MarslandShardlow}} where Pnt"><code>BridgeLandmarks.σt!</code></a></li><li><a href="#BridgeLandmarks.σtmul-Union{Tuple{Pnt}, Tuple{Any,Any,NState{Pnt,M} where M&lt;:AbstractArray{Pnt,2},Union{Landmarks, LandmarksAux}}} where Pnt"><code>BridgeLandmarks.σtmul</code></a></li><li><a href="#BridgeLandmarks.∇K̄-Tuple{Any,Any,Any}"><code>BridgeLandmarks.∇K̄</code></a></li><li><a href="#BridgeLandmarks.∇kernel-Tuple{Any,Union{Landmarks, LandmarksAux, MarslandShardlow, MarslandShardlowAux}}"><code>BridgeLandmarks.∇kernel</code></a></li><li><a href="#BridgeLandmarks.∇kernel-Tuple{Any,Any,Union{Landmarks, LandmarksAux, MarslandShardlow, MarslandShardlowAux}}"><code>BridgeLandmarks.∇kernel</code></a></li><li><a href="#BridgeLandmarks.∇z-NTuple{4,Any}"><code>BridgeLandmarks.∇z</code></a></li></ul><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="BridgeLandmarks.construct_nfs-Tuple{Any,Any,Any}" href="#BridgeLandmarks.construct_nfs-Tuple{Any,Any,Any}"><code>BridgeLandmarks.construct_nfs</code></a> — <span class="docstring-category">Method</span>.</div><div><div><pre><code class="language-julia">Construct sequence of Noisefields for AHS model
db: domainbound (sources are places on square grid specified by
    (-db:2nfstd:db) x -db:2nfstd:db
nfstd: standard deviation of noise fields (the smaller: the more noise fields we use)
γ: if set to one, then the value of the  noise field on the positions is approximately 1 at all locations in the domain</code></pre></div></div><a class="source-link" target="_blank" href="https://github.com/mschauer/BridgeLandmarks.jl/blob/7a4753a952f197728d282f1d25956726f5bf2efc/src/models.jl#LL289-L295">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="BridgeLandmarks.landmarksforward-Union{Tuple{Pnt}, Tuple{Any,NState{Pnt,M} where M&lt;:AbstractArray{Pnt,2},Any}} where Pnt" href="#BridgeLandmarks.landmarksforward-Union{Tuple{Pnt}, Tuple{Any,NState{Pnt,M} where M&lt;:AbstractArray{Pnt,2},Any}} where Pnt"><code>BridgeLandmarks.landmarksforward</code></a> — <span class="docstring-category">Method</span>.</div><div><div><pre><code class="language-julia">Forward simulate landmarks process specified by P on grid t.
Returns driving motion W and landmarks process X
t: time grid
x0: starting point
P: landmarks specification</code></pre></div></div><a class="source-link" target="_blank" href="https://github.com/mschauer/BridgeLandmarks.jl/blob/7a4753a952f197728d282f1d25956726f5bf2efc/src/patches.jl#LL295-L301">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="BridgeLandmarks.lm_mcmc-NTuple{15,Any}" href="#BridgeLandmarks.lm_mcmc-NTuple{15,Any}"><code>BridgeLandmarks.lm_mcmc</code></a> — <span class="docstring-category">Method</span>.</div><div><div><pre><code class="language-julia">Perform mcmc or sgd for landmarks model using the LM-parametrisation
tt_:      time grid
(xobs0,xobsT): observations at times 0 and T (at time T this is a vector)
σobs: standard deviation of Gaussian noise assumed on xobs0 and xobsT
mT: vector of momenta at time T used for constructing guiding term
P: target process

sampler: either sgd (stochastic gradient descent) or mcmc (Markov Chain Monte Carlo)
obs_atzero: Boolean, if true there is an observation at time zero
fixinitmomentato0: Boolean, if true we assume at time zero we observe zero momenta
xinit: initial guess on starting state

ITER: number of iterations
subsamples: vector of indices of iterations that are to be saved

ρ: Crank-Nicolson parameter (ρ=0 is independence sampler)
δ: step size for MALA updates on initial state (first component for positions, second component for momenta)
prior_a: prior on parameter a
prior_c: prior on parameter c
prior_γ: prior on parameter γ
σ_a: parameter determining update proposal for a [update a to aᵒ as aᵒ = a * exp(σ_a * rnorm())]
σ_c: parameter determining update proposal for c [update c to cᵒ as cᵒ = c * exp(σ_c * rnorm())]
σ_γ: parameter determining update proposal for γ [update γ to γᵒ as γᵒ = γ * exp(σ_γ * rnorm())]

outdir: output directory for animation
pb:: Lmplotbounds (axis used for plotting landmarks evolution)
updatepars: logical flag for updating pars a, c, γ
makefig: logical flag for making figures
showmomenta: logical flag if momenta are also drawn in figures

Returns:
Xsave: saved iterations of all states at all times in tt_
parsave: saved iterations of all parameter updates ,
objvals: saved values of stochastic approximation to loglikelihood
perc_acc: acceptance percentages (bridgepath - inital state)


anim, Xsave, parsave, objvals, perc_acc = lm_mcmc_mv(tt_, (xobs0,xobsTvec), σobs, mT, P,
         sampler, obs_atzero,
         xinit, ITER, subsamples,
        (δ, prior_a, prior_c, prior_γ, σ_a, σ_c, σ_γ),
        outdir, pb; updatepars = true, makefig=true, showmomenta=false)</code></pre></div></div><a class="source-link" target="_blank" href="https://github.com/mschauer/BridgeLandmarks.jl/blob/7a4753a952f197728d282f1d25956726f5bf2efc/src/lmguid.jl#LL552-L595">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="BridgeLandmarks.GuidRecursions" href="#BridgeLandmarks.GuidRecursions"><code>BridgeLandmarks.GuidRecursions</code></a> — <span class="docstring-category">Type</span>.</div><div><div><pre><code class="language-julia">GuidRecursions defines a struct that contains all info required for computing the guiding term and
likelihood (including ptilde term) for a single shape</code></pre></div></div><a class="source-link" target="_blank" href="https://github.com/mschauer/BridgeLandmarks.jl/blob/7a4753a952f197728d282f1d25956726f5bf2efc/src/lmguid.jl#LL49-L52">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="BridgeLandmarks.GuidedProposal!" href="#BridgeLandmarks.GuidedProposal!"><code>BridgeLandmarks.GuidedProposal!</code></a> — <span class="docstring-category">Type</span>.</div><div><div><pre><code class="language-julia">struct that contains target, auxiliary process for each shape, time grid, observation at time 0, observations
    at time T, number of shapes, and momenta in final state used for constructing the auxiliary processes
guidrec is a vector of GuidRecursions, which contains the results from the backward recursions and gpupdate step at time zero</code></pre></div></div><a class="source-link" target="_blank" href="https://github.com/mschauer/BridgeLandmarks.jl/blob/7a4753a952f197728d282f1d25956726f5bf2efc/src/lmguid.jl#LL68-L72">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="BridgeLandmarks.ObsInfo" href="#BridgeLandmarks.ObsInfo"><code>BridgeLandmarks.ObsInfo</code></a> — <span class="docstring-category">Type</span>.</div><div><div><pre><code class="language-julia">Observe V0 = L0 X0 + N(0,Σ0) and VT = LT X0 + N(0,ΣT)
μT is just a vector of zeros (possibly remove later)</code></pre></div></div><a class="source-link" target="_blank" href="https://github.com/mschauer/BridgeLandmarks.jl/blob/7a4753a952f197728d282f1d25956726f5bf2efc/src/lmguid.jl#LL3-L6">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="Base.:*-Tuple{BridgeLandmarks.InverseCholesky,Any}" href="#Base.:*-Tuple{BridgeLandmarks.InverseCholesky,Any}"><code>Base.:*</code></a> — <span class="docstring-category">Method</span>.</div><div><div><p>Compute y = H<em>X where Hinv = L</em>L&#39; (Cholesky decomposition</p><p>Input are L and X, output is Y</p><p>y=HX is equivalent to LL&#39;y=X, which can be solved by first backsolving LZ=X for z and next backsolving L&#39;Y=Z</p><p>L is a lower triangular matrix with element of type UncMat X is a matrix with elements of type UncMat Returns a matrix with elements of type UncMat</p></div></div><a class="source-link" target="_blank" href="https://github.com/mschauer/BridgeLandmarks.jl/blob/7a4753a952f197728d282f1d25956726f5bf2efc/src/state.jl#LL80-L92">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="Base.:*-Tuple{BridgeLandmarks.InverseCholesky,BridgeLandmarks.NState}" href="#Base.:*-Tuple{BridgeLandmarks.InverseCholesky,BridgeLandmarks.NState}"><code>Base.:*</code></a> — <span class="docstring-category">Method</span>.</div><div><div><p>Compute y = H<em>x where Hinv = L</em>L&#39; (Cholesky decomposition</p><p>Input are L and x, output is y</p><p>y=Hx is equivalent to LL&#39;y=x, which can be solved by first backsolving Lz=x for z and next backsolving L&#39;y=z</p><p>L is a lower triangular matrix with element of type UncMat x is a State or vector of points Returns a State (Todo: split up again and return vector for vector input)</p></div></div><a class="source-link" target="_blank" href="https://github.com/mschauer/BridgeLandmarks.jl/blob/7a4753a952f197728d282f1d25956726f5bf2efc/src/state.jl#LL56-L68">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="Base.conj!-Tuple{Array{#s24,2} where #s24&lt;:(StaticArrays.SArray{Tuple{2,2},T,2,4} where T)}" href="#Base.conj!-Tuple{Array{#s24,2} where #s24&lt;:(StaticArrays.SArray{Tuple{2,2},T,2,4} where T)}"><code>Base.conj!</code></a> — <span class="docstring-category">Method</span>.</div><div><div><p>Compute transpose of square matrix of Unc matrices</p><p>A = reshape([Unc(1:4), Unc(5:8), Unc(9:12), Unc(13:16)],2,2) B = copy(A) A conj!(B)</p></div></div><a class="source-link" target="_blank" href="https://github.com/mschauer/BridgeLandmarks.jl/blob/7a4753a952f197728d282f1d25956726f5bf2efc/src/patches.jl#LL262-L269">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="Base.show-Tuple{IO,BridgeLandmarks.NState}" href="#Base.show-Tuple{IO,BridgeLandmarks.NState}"><code>Base.show</code></a> — <span class="docstring-category">Method</span>.</div><div><div><p>Good display of variable of type State</p></div></div><a class="source-link" target="_blank" href="https://github.com/mschauer/BridgeLandmarks.jl/blob/7a4753a952f197728d282f1d25956726f5bf2efc/src/state.jl#LL32-L34">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="Bridge.B!-Tuple{Any,Any,Any,LandmarksAux}" href="#Bridge.B!-Tuple{Any,Any,Any,LandmarksAux}"><code>Bridge.B!</code></a> — <span class="docstring-category">Method</span>.</div><div><div><p>Compute B̃(t) * X (B̃ from auxiliary process) and write to out Both B̃(t) and X are of type UncMat</p></div></div><a class="source-link" target="_blank" href="https://github.com/mschauer/BridgeLandmarks.jl/blob/7a4753a952f197728d282f1d25956726f5bf2efc/src/models.jl#LL371-L374">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="Bridge.B!-Tuple{Any,Any,Any,MarslandShardlowAux}" href="#Bridge.B!-Tuple{Any,Any,Any,MarslandShardlowAux}"><code>Bridge.B!</code></a> — <span class="docstring-category">Method</span>.</div><div><div><p>Compute B̃(t) * X (B̃ from auxiliary process) and write to out Both B̃(t) and X are of type UncMat</p></div></div><a class="source-link" target="_blank" href="https://github.com/mschauer/BridgeLandmarks.jl/blob/7a4753a952f197728d282f1d25956726f5bf2efc/src/models.jl#LL163-L166">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="Bridge.B-Tuple{Any,LandmarksAux}" href="#Bridge.B-Tuple{Any,LandmarksAux}"><code>Bridge.B</code></a> — <span class="docstring-category">Method</span>.</div><div><div><p>Compute tildeB(t) for landmarks auxiliary process</p></div></div><a class="source-link" target="_blank" href="https://github.com/mschauer/BridgeLandmarks.jl/blob/7a4753a952f197728d282f1d25956726f5bf2efc/src/models.jl#LL351-L353">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="Bridge.B-Tuple{Any,MarslandShardlowAux}" href="#Bridge.B-Tuple{Any,MarslandShardlowAux}"><code>Bridge.B</code></a> — <span class="docstring-category">Method</span>.</div><div><div><p>Compute tildeB(t) for landmarks auxiliary process</p></div></div><a class="source-link" target="_blank" href="https://github.com/mschauer/BridgeLandmarks.jl/blob/7a4753a952f197728d282f1d25956726f5bf2efc/src/models.jl#LL148-L150">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="Bridge._b!-Tuple{Any,BridgeLandmarks.NState,BridgeLandmarks.NState,BridgeLandmarks.GuidedProposal!,Any}" href="#Bridge._b!-Tuple{Any,BridgeLandmarks.NState,BridgeLandmarks.NState,BridgeLandmarks.GuidedProposal!,Any}"><code>Bridge._b!</code></a> — <span class="docstring-category">Method</span>.</div><div><div><pre><code class="language-julia">Evaluate drift bᵒ of guided proposal at (t,x), write into out</code></pre></div></div><a class="source-link" target="_blank" href="https://github.com/mschauer/BridgeLandmarks.jl/blob/7a4753a952f197728d282f1d25956726f5bf2efc/src/lmguid.jl#LL233-L235">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="Bridge.a-Tuple{Any,Union{MarslandShardlow, MarslandShardlowAux}}" href="#Bridge.a-Tuple{Any,Union{MarslandShardlow, MarslandShardlowAux}}"><code>Bridge.a</code></a> — <span class="docstring-category">Method</span>.</div><div><div><p>Returns matrix a(t) for Marsland-Shardlow model</p></div></div><a class="source-link" target="_blank" href="https://github.com/mschauer/BridgeLandmarks.jl/blob/7a4753a952f197728d282f1d25956726f5bf2efc/src/models.jl#LL195-L197">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="Bridge.b!-Tuple{Any,Any,Any,LandmarksAux}" href="#Bridge.b!-Tuple{Any,Any,Any,LandmarksAux}"><code>Bridge.b!</code></a> — <span class="docstring-category">Method</span>.</div><div><div><p>Evaluate drift of landmarks auxiliary process in (t,x) and save to out x is a state and out as well</p></div></div><a class="source-link" target="_blank" href="https://github.com/mschauer/BridgeLandmarks.jl/blob/7a4753a952f197728d282f1d25956726f5bf2efc/src/models.jl#LL327-L330">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="Bridge.b!-Tuple{Any,Any,Any,Landmarks}" href="#Bridge.b!-Tuple{Any,Any,Any,Landmarks}"><code>Bridge.b!</code></a> — <span class="docstring-category">Method</span>.</div><div><div><p>Evaluate drift of landmarks in (t,x) and save to out x is a state and out as well</p></div></div><a class="source-link" target="_blank" href="https://github.com/mschauer/BridgeLandmarks.jl/blob/7a4753a952f197728d282f1d25956726f5bf2efc/src/models.jl#LL305-L308">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="Bridge.b!-Tuple{Any,Any,Any,MarslandShardlow}" href="#Bridge.b!-Tuple{Any,Any,Any,MarslandShardlow}"><code>Bridge.b!</code></a> — <span class="docstring-category">Method</span>.</div><div><div><p>Evaluate drift of landmarks in (t,x) and save to out x is a state and out as well</p></div></div><a class="source-link" target="_blank" href="https://github.com/mschauer/BridgeLandmarks.jl/blob/7a4753a952f197728d282f1d25956726f5bf2efc/src/models.jl#LL106-L109">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="Bridge.σ!-Tuple{Any,Any,Any,Any,BridgeLandmarks.GuidedProposal!}" href="#Bridge.σ!-Tuple{Any,Any,Any,Any,BridgeLandmarks.GuidedProposal!}"><code>Bridge.σ!</code></a> — <span class="docstring-category">Method</span>.</div><div><div><pre><code class="language-julia">Evaluate σ(t,x) dW and write into out</code></pre></div></div><a class="source-link" target="_blank" href="https://github.com/mschauer/BridgeLandmarks.jl/blob/7a4753a952f197728d282f1d25956726f5bf2efc/src/lmguid.jl#LL242-L244">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="Bridge.σ!-Tuple{Any,Any,Any,Any,Union{Landmarks, LandmarksAux}}" href="#Bridge.σ!-Tuple{Any,Any,Any,Any,Union{Landmarks, LandmarksAux}}"><code>Bridge.σ!</code></a> — <span class="docstring-category">Method</span>.</div><div><div><p>Compute sigma(t,x) * dm where dm is a vector and sigma is the diffusion coefficient of landmarks write to out which is of type State</p></div></div><a class="source-link" target="_blank" href="https://github.com/mschauer/BridgeLandmarks.jl/blob/7a4753a952f197728d282f1d25956726f5bf2efc/src/models.jl#LL414-L417">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="Bridge.σ!-Tuple{Any,Any,Any,Any,Union{MarslandShardlow, MarslandShardlowAux}}" href="#Bridge.σ!-Tuple{Any,Any,Any,Any,Union{MarslandShardlow, MarslandShardlowAux}}"><code>Bridge.σ!</code></a> — <span class="docstring-category">Method</span>.</div><div><div><pre><code class="language-julia">compute σ(t,x) * dm and write to out</code></pre></div></div><a class="source-link" target="_blank" href="https://github.com/mschauer/BridgeLandmarks.jl/blob/7a4753a952f197728d282f1d25956726f5bf2efc/src/models.jl#LL184-L186">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="BridgeLandmarks.HMC-NTuple{5,Any}" href="#BridgeLandmarks.HMC-NTuple{5,Any}"><code>BridgeLandmarks.HMC</code></a> — <span class="docstring-category">Method</span>.</div><div><div><pre><code class="language-julia">Adapting Radford Neal&#39;s R implementation of Hamiltonian Monte Carlo with
stepsize ϵ and L steps</code></pre></div></div><a class="source-link" target="_blank" href="https://github.com/mschauer/BridgeLandmarks.jl/blob/7a4753a952f197728d282f1d25956726f5bf2efc/src/patches.jl#LL333-L336">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="BridgeLandmarks._r!-Tuple{Any,BridgeLandmarks.NState,BridgeLandmarks.NState,BridgeLandmarks.GuidedProposal!,Any}" href="#BridgeLandmarks._r!-Tuple{Any,BridgeLandmarks.NState,BridgeLandmarks.NState,BridgeLandmarks.GuidedProposal!,Any}"><code>BridgeLandmarks._r!</code></a> — <span class="docstring-category">Method</span>.</div><div><div><pre><code class="language-julia">Evaluate tilder (appearing in guiding term of guided proposal) at (t,x), write into out</code></pre></div></div><a class="source-link" target="_blank" href="https://github.com/mschauer/BridgeLandmarks.jl/blob/7a4753a952f197728d282f1d25956726f5bf2efc/src/lmguid.jl#LL247-L249">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="BridgeLandmarks.amul-Tuple{Any,BridgeLandmarks.NState,Array{#s17,1} where #s17&lt;:(StaticArrays.SArray{Tuple{2},T,1,2} where T),Union{Landmarks, LandmarksAux}}" href="#BridgeLandmarks.amul-Tuple{Any,BridgeLandmarks.NState,Array{#s17,1} where #s17&lt;:(StaticArrays.SArray{Tuple{2},T,1,2} where T),Union{Landmarks, LandmarksAux}}"><code>BridgeLandmarks.amul</code></a> — <span class="docstring-category">Method</span>.</div><div><div><p>Multiply a(t,x) times a vector of points Returns a State (first multiply with sigma&#39;, via function σtmul, next left-multiply this vector with σ)</p></div></div><a class="source-link" target="_blank" href="https://github.com/mschauer/BridgeLandmarks.jl/blob/7a4753a952f197728d282f1d25956726f5bf2efc/src/models.jl#LL518-L522">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="BridgeLandmarks.amul-Tuple{Any,BridgeLandmarks.NState,BridgeLandmarks.NState,Union{Landmarks, LandmarksAux}}" href="#BridgeLandmarks.amul-Tuple{Any,BridgeLandmarks.NState,BridgeLandmarks.NState,Union{Landmarks, LandmarksAux}}"><code>BridgeLandmarks.amul</code></a> — <span class="docstring-category">Method</span>.</div><div><div><p>Multiply a(t,x) times a state Returns a state (first multiply with sigma&#39;, via function σtmul, next left-multiply this vector with σ)</p></div></div><a class="source-link" target="_blank" href="https://github.com/mschauer/BridgeLandmarks.jl/blob/7a4753a952f197728d282f1d25956726f5bf2efc/src/models.jl#LL530-L534">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="BridgeLandmarks.amul-Tuple{Any,BridgeLandmarks.NState,BridgeLandmarks.NState,Union{MarslandShardlow, MarslandShardlowAux}}" href="#BridgeLandmarks.amul-Tuple{Any,BridgeLandmarks.NState,BridgeLandmarks.NState,Union{MarslandShardlow, MarslandShardlowAux}}"><code>BridgeLandmarks.amul</code></a> — <span class="docstring-category">Method</span>.</div><div><div><p>Multiply a(t,x) times xin (which is of type state) Returns variable of type State</p></div></div><a class="source-link" target="_blank" href="https://github.com/mschauer/BridgeLandmarks.jl/blob/7a4753a952f197728d282f1d25956726f5bf2efc/src/models.jl#LL210-L213">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="BridgeLandmarks.cholinverse!-Tuple{Any,Any}" href="#BridgeLandmarks.cholinverse!-Tuple{Any,Any}"><code>BridgeLandmarks.cholinverse!</code></a> — <span class="docstring-category">Method</span>.</div><div><div><p>Solve L L&#39;y =x using two backsolves, L should be lower triangular</p></div></div><a class="source-link" target="_blank" href="https://github.com/mschauer/BridgeLandmarks.jl/blob/7a4753a952f197728d282f1d25956726f5bf2efc/src/state.jl#LL39-L42">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="BridgeLandmarks.convert_samplepath-Tuple{Any}" href="#BridgeLandmarks.convert_samplepath-Tuple{Any}"><code>BridgeLandmarks.convert_samplepath</code></a> — <span class="docstring-category">Method</span>.</div><div><div><pre><code class="language-julia">Useful for storage of a samplepath of states
Ordering is as follows:
1) time
2) landmark nr
3) for each landmark: q1, q2 p1, p2

With m time-steps, n landmarks, this entails a vector of length m * n * 2 * d</code></pre></div></div><a class="source-link" target="_blank" href="https://github.com/mschauer/BridgeLandmarks.jl/blob/7a4753a952f197728d282f1d25956726f5bf2efc/src/plotting.jl#LL77-L85">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="BridgeLandmarks.convert_samplepath-Tuple{Array{T,1} where T}" href="#BridgeLandmarks.convert_samplepath-Tuple{Array{T,1} where T}"><code>BridgeLandmarks.convert_samplepath</code></a> — <span class="docstring-category">Method</span>.</div><div><div><pre><code class="language-julia">Useful for storage of a samplepath of states
Ordering is as follows:
0) shape
1) time
2) landmark nr
3) for each landmark: q1, q2 p1, p2

With m time-steps, n landmarks, this entails a vector of length m * n * 2 * d</code></pre></div></div><a class="source-link" target="_blank" href="https://github.com/mschauer/BridgeLandmarks.jl/blob/7a4753a952f197728d282f1d25956726f5bf2efc/src/plotting.jl#LL91-L100">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="BridgeLandmarks.getpars-Tuple{BridgeLandmarks.GuidedProposal!}" href="#BridgeLandmarks.getpars-Tuple{BridgeLandmarks.GuidedProposal!}"><code>BridgeLandmarks.getpars</code></a> — <span class="docstring-category">Method</span>.</div><div><div><pre><code class="language-julia">Extract parameters from GuidedProposal! Q</code></pre></div></div><a class="source-link" target="_blank" href="https://github.com/mschauer/BridgeLandmarks.jl/blob/7a4753a952f197728d282f1d25956726f5bf2efc/src/lmguid.jl#LL90-L92">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="BridgeLandmarks.guidingbackwards!-Tuple{BridgeLandmarks.Lm,Any,Any,Any,Any}" href="#BridgeLandmarks.guidingbackwards!-Tuple{BridgeLandmarks.Lm,Any,Any,Any,Any}"><code>BridgeLandmarks.guidingbackwards!</code></a> — <span class="docstring-category">Method</span>.</div><div><div><pre><code class="language-julia">Solve backwards recursions in L, M, μ parametrisation on grid t
implicit: if true, Euler backwards is used for solving ODE for Lt, else Euler forwards is used

Case lowrank=true still gives an error: fixme!</code></pre></div></div><a class="source-link" target="_blank" href="https://github.com/mschauer/BridgeLandmarks.jl/blob/7a4753a952f197728d282f1d25956726f5bf2efc/src/lmguid.jl#LL182-L187">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="BridgeLandmarks.hamiltonian-Tuple{Any,Any}" href="#BridgeLandmarks.hamiltonian-Tuple{Any,Any}"><code>BridgeLandmarks.hamiltonian</code></a> — <span class="docstring-category">Method</span>.</div><div><div><p>Hamiltonian for deterministic part of landmarks model</p></div></div><a class="source-link" target="_blank" href="https://github.com/mschauer/BridgeLandmarks.jl/blob/7a4753a952f197728d282f1d25956726f5bf2efc/src/models.jl#LL86-L88">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="BridgeLandmarks.init_guidrec-Tuple{Any,Any,Any}" href="#BridgeLandmarks.init_guidrec-Tuple{Any,Any,Any}"><code>BridgeLandmarks.init_guidrec</code></a> — <span class="docstring-category">Method</span>.</div><div><div><pre><code class="language-julia">Initialise (allocate memory) a struct of type GuidRecursions for a single shape
guidres = init_guidrec((t,obs_info,xobs0)</code></pre></div></div><a class="source-link" target="_blank" href="https://github.com/mschauer/BridgeLandmarks.jl/blob/7a4753a952f197728d282f1d25956726f5bf2efc/src/lmguid.jl#LL115-L118">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="BridgeLandmarks.kernel-Tuple{Any,Union{Landmarks, LandmarksAux, MarslandShardlow, MarslandShardlowAux}}" href="#BridgeLandmarks.kernel-Tuple{Any,Union{Landmarks, LandmarksAux, MarslandShardlow, MarslandShardlowAux}}"><code>BridgeLandmarks.kernel</code></a> — <span class="docstring-category">Method</span>.</div><div><div><p>kernel in Hamiltonian</p></div></div><a class="source-link" target="_blank" href="https://github.com/mschauer/BridgeLandmarks.jl/blob/7a4753a952f197728d282f1d25956726f5bf2efc/src/models.jl#LL64-L66">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="BridgeLandmarks.lm_gpupdate!-Union{Tuple{Pnt}, Tuple{Any,Array{Pnt,2},Any,Any,Any,Any,Any}} where Pnt" href="#BridgeLandmarks.lm_gpupdate!-Union{Tuple{Pnt}, Tuple{Any,Array{Pnt,2},Any,Any,Any,Any,Any}} where Pnt"><code>BridgeLandmarks.lm_gpupdate!</code></a> — <span class="docstring-category">Method</span>.</div><div><div><pre><code class="language-julia">Guided proposal update for newly incoming observation at time zero.
Information on new observations at time zero is (L0, Σ0, xobs0)
Values just after time zero, (Lt0₊, Mt⁺0₊, μt0₊) are updated to time zero, the result being
written into (Lt0, Mt⁺0, μt0)</code></pre></div></div><a class="source-link" target="_blank" href="https://github.com/mschauer/BridgeLandmarks.jl/blob/7a4753a952f197728d282f1d25956726f5bf2efc/src/lmguid.jl#LL140-L145">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="BridgeLandmarks.lyapunovpsdbackward_step!-NTuple{7,Any}" href="#BridgeLandmarks.lyapunovpsdbackward_step!-NTuple{7,Any}"><code>BridgeLandmarks.lyapunovpsdbackward_step!</code></a> — <span class="docstring-category">Method</span>.</div><div><div><p>Version where B̃ and ã do not depend on try</p></div></div><a class="source-link" target="_blank" href="https://github.com/mschauer/BridgeLandmarks.jl/blob/7a4753a952f197728d282f1d25956726f5bf2efc/src/patches.jl#LL251-L253">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="BridgeLandmarks.lρtilde-Tuple{Any,Any,Any}" href="#BridgeLandmarks.lρtilde-Tuple{Any,Any,Any}"><code>BridgeLandmarks.lρtilde</code></a> — <span class="docstring-category">Method</span>.</div><div><div><pre><code class="language-julia">Compute log tildeρ(0,x_0) for the k-th shape</code></pre></div></div><a class="source-link" target="_blank" href="https://github.com/mschauer/BridgeLandmarks.jl/blob/7a4753a952f197728d282f1d25956726f5bf2efc/src/lmguid.jl#LL256-L258">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="BridgeLandmarks.plotshapes-NTuple{4,Any}" href="#BridgeLandmarks.plotshapes-NTuple{4,Any}"><code>BridgeLandmarks.plotshapes</code></a> — <span class="docstring-category">Method</span>.</div><div><div><p>plot initial and final shape, given by xobs0 and xobsT respectively</p></div></div><a class="source-link" target="_blank" href="https://github.com/mschauer/BridgeLandmarks.jl/blob/7a4753a952f197728d282f1d25956726f5bf2efc/src/plotting.jl#LL112-L114">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="BridgeLandmarks.putpars!-Tuple{BridgeLandmarks.GuidedProposal!,Any}" href="#BridgeLandmarks.putpars!-Tuple{BridgeLandmarks.GuidedProposal!,Any}"><code>BridgeLandmarks.putpars!</code></a> — <span class="docstring-category">Method</span>.</div><div><div><pre><code class="language-julia">update parameter values in GuidedProposal! Q, i.e.
new values are written into Q.target and Q.aux is updated accordingly</code></pre></div></div><a class="source-link" target="_blank" href="https://github.com/mschauer/BridgeLandmarks.jl/blob/7a4753a952f197728d282f1d25956726f5bf2efc/src/lmguid.jl#LL99-L102">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="BridgeLandmarks.set_obsinfo-Tuple{Any,Bool,Bool,Any,Any}" href="#BridgeLandmarks.set_obsinfo-Tuple{Any,Bool,Bool,Any,Any}"><code>BridgeLandmarks.set_obsinfo</code></a> — <span class="docstring-category">Method</span>.</div><div><div><pre><code class="language-julia">Make ObsInfo object

Three cases:
1) obs_atzero=true: this refers to the case of observing one landmark configuration at times 0 and T
2) obs_atzero=false &amp; fixinitmomentato0=false: case of observing multiple shapes at time T,
    both positions and momenta at time zero assumed unknown
3) obs_atzero=false &amp; fixinitmomentato0=true: case of observing multiple shapes at time T,
    positions at time zero assumed unknown, momenta at time 0 are fixed to zero</code></pre></div></div><a class="source-link" target="_blank" href="https://github.com/mschauer/BridgeLandmarks.jl/blob/7a4753a952f197728d282f1d25956726f5bf2efc/src/lmguid.jl#LL19-L28">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="BridgeLandmarks.simguidedlm_llikelihood!-Tuple{Bridge.LeftRule,Any,Any,Any,BridgeLandmarks.GuidedProposal!,Any}" href="#BridgeLandmarks.simguidedlm_llikelihood!-Tuple{Bridge.LeftRule,Any,Any,Any,BridgeLandmarks.GuidedProposal!,Any}"><code>BridgeLandmarks.simguidedlm_llikelihood!</code></a> — <span class="docstring-category">Method</span>.</div><div><div><pre><code class="language-julia">Simulate guided proposal and compute loglikelihood for one shape
Solve sde inplace and return loglikelihood (thereby avoiding &#39;double&#39; computations)</code></pre></div></div><a class="source-link" target="_blank" href="https://github.com/mschauer/BridgeLandmarks.jl/blob/7a4753a952f197728d282f1d25956726f5bf2efc/src/lmguid.jl#LL265-L268">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="BridgeLandmarks.simguidedlm_llikelihood!-Tuple{Bridge.LeftRule,Any,Any,Any,BridgeLandmarks.GuidedProposal!}" href="#BridgeLandmarks.simguidedlm_llikelihood!-Tuple{Bridge.LeftRule,Any,Any,Any,BridgeLandmarks.GuidedProposal!}"><code>BridgeLandmarks.simguidedlm_llikelihood!</code></a> — <span class="docstring-category">Method</span>.</div><div><div><pre><code class="language-julia">Simulate guided proposal and compute loglikelihood (vector version, multiple shapes)

solve sde inplace and return loglikelihood (thereby avoiding &#39;double&#39; computations)</code></pre></div></div><a class="source-link" target="_blank" href="https://github.com/mschauer/BridgeLandmarks.jl/blob/7a4753a952f197728d282f1d25956726f5bf2efc/src/lmguid.jl#LL323-L327">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="BridgeLandmarks.slogρ!-NTuple{5,Any}" href="#BridgeLandmarks.slogρ!-NTuple{5,Any}"><code>BridgeLandmarks.slogρ!</code></a> — <span class="docstring-category">Method</span>.</div><div><div><pre><code class="language-julia">Stochastic approximation for loglikelihood.

Simulate guided proposal and compute loglikelihood for starting point x0,
guided proposals defined by Q and Wiener increments in W.
Guided proposals are written into X.
Writes vector of loglikelihoods into llout.
Returns sum of loglikelihoods</code></pre></div></div><a class="source-link" target="_blank" href="https://github.com/mschauer/BridgeLandmarks.jl/blob/7a4753a952f197728d282f1d25956726f5bf2efc/src/lmguid.jl#LL376-L384">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="BridgeLandmarks.update_guidrec!-Tuple{Any,Any}" href="#BridgeLandmarks.update_guidrec!-Tuple{Any,Any}"><code>BridgeLandmarks.update_guidrec!</code></a> — <span class="docstring-category">Method</span>.</div><div><div><pre><code class="language-julia">Compute backward recursion for all shapes and write into field Q.guidrec</code></pre></div></div><a class="source-link" target="_blank" href="https://github.com/mschauer/BridgeLandmarks.jl/blob/7a4753a952f197728d282f1d25956726f5bf2efc/src/lmguid.jl#LL158-L160">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="BridgeLandmarks.update_initialstate!-Tuple{Any,Any,Any,Any,Any,Any,Any,Any,Any,BridgeLandmarks.GuidedProposal!,Any,Any}" href="#BridgeLandmarks.update_initialstate!-Tuple{Any,Any,Any,Any,Any,Any,Any,Any,Any,BridgeLandmarks.GuidedProposal!,Any,Any}"><code>BridgeLandmarks.update_initialstate!</code></a> — <span class="docstring-category">Method</span>.</div><div><div><pre><code class="language-julia">update initial state
X:  current iterate of vector of sample paths
Xᵒ: vector of sample paths to write proposal into
W:  current vector of Wiener increments
ll: current value of loglikelihood
x, xᵒ, ∇x, ∇xᵒ: allocated vectors for initial state and its gradient
sampler: either sgd (not checked yet) or mcmc
Q::GuidedProposal!
δ: vector with MALA stepsize for initial state positions (δ[1]) and initial state momenta (δ[2])
updatekernel:  can be :mala_pos, :mala_mom, :rmmala_pos</code></pre></div></div><a class="source-link" target="_blank" href="https://github.com/mschauer/BridgeLandmarks.jl/blob/7a4753a952f197728d282f1d25956726f5bf2efc/src/lmguid.jl#LL394-L405">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="BridgeLandmarks.update_pars!-NTuple{10,Any}" href="#BridgeLandmarks.update_pars!-NTuple{10,Any}"><code>BridgeLandmarks.update_pars!</code></a> — <span class="docstring-category">Method</span>.</div><div><div><pre><code class="language-julia">For fixed Wiener increments and initial state, update parameters by random-walk-MH</code></pre></div></div><a class="source-link" target="_blank" href="https://github.com/mschauer/BridgeLandmarks.jl/blob/7a4753a952f197728d282f1d25956726f5bf2efc/src/lmguid.jl#LL512-L514">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="BridgeLandmarks.update_path!-NTuple{10,Any}" href="#BridgeLandmarks.update_path!-NTuple{10,Any}"><code>BridgeLandmarks.update_path!</code></a> — <span class="docstring-category">Method</span>.</div><div><div><pre><code class="language-julia">update bridges for all shapes using Crank-Nicholsen scheme with parameter ρ (only in case the method is mcmc)
Newly accepted bridges are written into (X,W), loglikelihood on each segment is written into vector ll

update_path!(X,Xᵒ,W,Wᵒ,Wnew,ll,x, Q, ρ, acc_pcn)</code></pre></div></div><a class="source-link" target="_blank" href="https://github.com/mschauer/BridgeLandmarks.jl/blob/7a4753a952f197728d282f1d25956726f5bf2efc/src/lmguid.jl#LL344-L349">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="BridgeLandmarks.z-NTuple{4,Any}" href="#BridgeLandmarks.z-NTuple{4,Any}"><code>BridgeLandmarks.z</code></a> — <span class="docstring-category">Method</span>.</div><div><div><pre><code class="language-julia">Define z(q) = &lt; ∇K̄(q - δ,τ), λ &gt;
Required for Stratonovich -&gt; Ito correction in AHS-model</code></pre></div></div><a class="source-link" target="_blank" href="https://github.com/mschauer/BridgeLandmarks.jl/blob/7a4753a952f197728d282f1d25956726f5bf2efc/src/models.jl#LL245-L248">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="BridgeLandmarks.σp-Tuple{Any,Any,BridgeLandmarks.Noisefield}" href="#BridgeLandmarks.σp-Tuple{Any,Any,BridgeLandmarks.Noisefield}"><code>BridgeLandmarks.σp</code></a> — <span class="docstring-category">Method</span>.</div><div><div><pre><code class="language-julia">Suppose one noise field nf
Returns diagonal matrix with noisefield for momentum at point location q (can be vector or Point)</code></pre></div></div><a class="source-link" target="_blank" href="https://github.com/mschauer/BridgeLandmarks.jl/blob/7a4753a952f197728d282f1d25956726f5bf2efc/src/models.jl#LL264-L267">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="BridgeLandmarks.σq-Tuple{Any,Array{#s13,1} where #s13&lt;:BridgeLandmarks.Noisefield}" href="#BridgeLandmarks.σq-Tuple{Any,Array{#s13,1} where #s13&lt;:BridgeLandmarks.Noisefield}"><code>BridgeLandmarks.σq</code></a> — <span class="docstring-category">Method</span>.</div><div><div><pre><code class="language-julia">For AHS model compute total noise field on position experienced at a point x.
Useful for plotting purposes.

Example usage:
    σq(Point(0.0, 0.0), nfs)
    σq([0.0; 0.0], nfs)</code></pre></div></div><a class="source-link" target="_blank" href="https://github.com/mschauer/BridgeLandmarks.jl/blob/7a4753a952f197728d282f1d25956726f5bf2efc/src/models.jl#LL271-L278">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="BridgeLandmarks.σq-Tuple{Any,BridgeLandmarks.Noisefield}" href="#BridgeLandmarks.σq-Tuple{Any,BridgeLandmarks.Noisefield}"><code>BridgeLandmarks.σq</code></a> — <span class="docstring-category">Method</span>.</div><div><div><pre><code class="language-julia">Suppose one noise field nf
Returns diagonal matrix with noisefield for position at point location q (can be vector or Point)</code></pre></div></div><a class="source-link" target="_blank" href="https://github.com/mschauer/BridgeLandmarks.jl/blob/7a4753a952f197728d282f1d25956726f5bf2efc/src/models.jl#LL258-L261">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="BridgeLandmarks.σt!-Union{Tuple{Pnt}, Tuple{Any,Any,NState{Pnt,M} where M&lt;:AbstractArray{Pnt,2},Any,MarslandShardlow}} where Pnt" href="#BridgeLandmarks.σt!-Union{Tuple{Pnt}, Tuple{Any,Any,NState{Pnt,M} where M&lt;:AbstractArray{Pnt,2},Any,MarslandShardlow}} where Pnt"><code>BridgeLandmarks.σt!</code></a> — <span class="docstring-category">Method</span>.</div><div><div><pre><code class="language-julia">compute σ(t,x)&#39; y, where y::State
the result is a vector of points that is written to out</code></pre></div></div><a class="source-link" target="_blank" href="https://github.com/mschauer/BridgeLandmarks.jl/blob/7a4753a952f197728d282f1d25956726f5bf2efc/src/models.jl#LL454-L457">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="BridgeLandmarks.σt!-Union{Tuple{Pnt}, Tuple{Any,Any,NState{Pnt,M} where M&lt;:AbstractArray{Pnt,2},Any,Union{Landmarks, LandmarksAux}}} where Pnt" href="#BridgeLandmarks.σt!-Union{Tuple{Pnt}, Tuple{Any,Any,NState{Pnt,M} where M&lt;:AbstractArray{Pnt,2},Any,Union{Landmarks, LandmarksAux}}} where Pnt"><code>BridgeLandmarks.σt!</code></a> — <span class="docstring-category">Method</span>.</div><div><div><pre><code class="language-julia">compute σ(t,x)&#39; y, where y::State
the result is a vector of points that is written to out</code></pre></div></div><a class="source-link" target="_blank" href="https://github.com/mschauer/BridgeLandmarks.jl/blob/7a4753a952f197728d282f1d25956726f5bf2efc/src/models.jl#LL466-L469">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="BridgeLandmarks.σtmul-Union{Tuple{Pnt}, Tuple{Any,Any,NState{Pnt,M} where M&lt;:AbstractArray{Pnt,2},Union{Landmarks, LandmarksAux}}} where Pnt" href="#BridgeLandmarks.σtmul-Union{Tuple{Pnt}, Tuple{Any,Any,NState{Pnt,M} where M&lt;:AbstractArray{Pnt,2},Union{Landmarks, LandmarksAux}}} where Pnt"><code>BridgeLandmarks.σtmul</code></a> — <span class="docstring-category">Method</span>.</div><div><div><p>Compute sigma(t,x)&#39; * y where y is a state and sigma is the diffusion coefficient of landmarks returns a vector of points of length P.nfs</p></div></div><a class="source-link" target="_blank" href="https://github.com/mschauer/BridgeLandmarks.jl/blob/7a4753a952f197728d282f1d25956726f5bf2efc/src/models.jl#LL434-L437">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="BridgeLandmarks.∇K̄-Tuple{Any,Any,Any}" href="#BridgeLandmarks.∇K̄-Tuple{Any,Any,Any}"><code>BridgeLandmarks.∇K̄</code></a> — <span class="docstring-category">Method</span>.</div><div><div><p>Needed for b! in case P is auxiliary process</p></div></div><a class="source-link" target="_blank" href="https://github.com/mschauer/BridgeLandmarks.jl/blob/7a4753a952f197728d282f1d25956726f5bf2efc/src/models.jl#LL238-L240">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="BridgeLandmarks.∇kernel-Tuple{Any,Any,Union{Landmarks, LandmarksAux, MarslandShardlow, MarslandShardlowAux}}" href="#BridgeLandmarks.∇kernel-Tuple{Any,Any,Union{Landmarks, LandmarksAux, MarslandShardlow, MarslandShardlowAux}}"><code>BridgeLandmarks.∇kernel</code></a> — <span class="docstring-category">Method</span>.</div><div><div><p>Needed for b! in case P is auxiliary process</p></div></div><a class="source-link" target="_blank" href="https://github.com/mschauer/BridgeLandmarks.jl/blob/7a4753a952f197728d282f1d25956726f5bf2efc/src/models.jl#LL79-L81">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="BridgeLandmarks.∇kernel-Tuple{Any,Union{Landmarks, LandmarksAux, MarslandShardlow, MarslandShardlowAux}}" href="#BridgeLandmarks.∇kernel-Tuple{Any,Union{Landmarks, LandmarksAux, MarslandShardlow, MarslandShardlowAux}}"><code>BridgeLandmarks.∇kernel</code></a> — <span class="docstring-category">Method</span>.</div><div><div><p>gradient of kernel in hamiltonian</p></div></div><a class="source-link" target="_blank" href="https://github.com/mschauer/BridgeLandmarks.jl/blob/7a4753a952f197728d282f1d25956726f5bf2efc/src/models.jl#LL72-L74">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="BridgeLandmarks.∇z-NTuple{4,Any}" href="#BridgeLandmarks.∇z-NTuple{4,Any}"><code>BridgeLandmarks.∇z</code></a> — <span class="docstring-category">Method</span>.</div><div><div><pre><code class="language-julia">Define ∇z(q) = ∇ &lt; ∇K̄(q - δ,τ), λ &gt;
Required for Stratonovich -&gt; Ito correction in AHS-model</code></pre></div></div><a class="source-link" target="_blank" href="https://github.com/mschauer/BridgeLandmarks.jl/blob/7a4753a952f197728d282f1d25956726f5bf2efc/src/models.jl#LL251-L254">source</a></section><footer><hr/></footer></article></body></html>
